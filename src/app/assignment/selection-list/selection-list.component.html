<div class="row gx-0">
  <div class="col-12">
    <div class="d-flex">
      <button class="m-2" mat-raised-button type="button" routerLink="..">
        {{ "BUTTON_CANCEL" | transloco }}
      </button>
      <mat-icon
        class="m-2"
        svgIcon="pdf"
        aria-label="icon"
        (click)="toPdf()"
      ></mat-icon>
      <mat-icon
        class="m-2"
        svgIcon="png"
        aria-label="icon"
        (click)="toPng()"
      ></mat-icon>
      <mat-icon
        class="m-2"
        svgIcon="excel"
        aria-label="icon"
        (click)="toExcel()"
      ></mat-icon>
    </div>
  </div>
</div>

<div id="toPngDivId" style="width: 40rem; height: 100%" class="bg-color-white">
  <ng-container *ngFor="let ag of assignmentGroups; index as i">
    <table [id]="'table' + i">
      <tr>
        <th
          class="bold"
          [style.background]="defaultReportDateColor"
          [style.fontSize]="defaultReportFontSize"
        >
          {{
            ag.date
              | translocoDate
                : {
                    dateStyle: defaultReportDateFormat
                  }
          }}
        </th>
        <th [style.background]="defaultReportDateColor">
          {{ ag.room }}
        </th>
      </tr>
      <tr *ngFor="let assignment of ag.assignments">
        <td
          class="bold me-3"
          [style.background]="
            assignTypeService.getAssignTypeByName(assignment.assignType).color
          "
          [style.fontSize]="defaultReportFontSize"
        >
          <div>{{ assignment.theme }}</div>
          <span *ngIf="!assignment.theme">{{ assignment.assignType }}</span>
        </td>
        <td [style.fontSize]="defaultReportFontSize">
          {{ assignment.principal
          }}<span *ngIf="assignment.assistant">
            / <br />
            {{ assignment.assistant }}</span
          >
        </td>
      </tr>
    </table>
  </ng-container>
</div>
