<div class="d-flex">
  <button class="m-2" mat-raised-button type="button" routerLink="..">
    {{ "BUTTON_CANCEL" | transloco }}
  </button>
  <mat-icon
    class="m-2"
    svgIcon="pdf"
    aria-label="icon"
    (click)="toPdf()"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="pdfblue"
    aria-label="icon"
    (click)="toPdfForPrint()"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="png"
    aria-label="icon"
    (click)="toPng()"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="excel"
    aria-label="icon"
    (click)="toExcel()"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="colorpicker"
    cpColorMode="presets"
    [(colorPicker)]="colorpicker"
    cpAlphaChannel="disabled"
    [cpPresetColors]="[
      '#fff',
      '#dbf7fa',
      '#dbfae5',
      '#fcffe6',
      '#ffebe6',
      '#f5e6ff'
    ]"
    aria-label="icon"
  ></mat-icon>
</div>

<div id="toPngDivId" style="width: 40rem" class="bg-color-white">
  <h3 [style.textAlign]="'center'">{{ reportTitle }}</h3>
  <ng-container *ngFor="let ag of assignmentGroups; index as i">
    <table
      [id]="'table' + i"
      [style.cursor]="colorpicker ? 'cell' : 'default'"
      (click)="changeBackgroundColor($event)"
    >
      <tr>
        <th
          class="bold"
          [style.backgroundColor]="defaultReportDateColor"
          [style.fontSize]="defaultReportFontSize"
        >
          {{
            ag.date
              | translocoDate
                : {
                    dateStyle: defaultReportDateFormat
                  }
          }}
        </th>
        <th
          [style.backgroundColor]="defaultReportDateColor"
          [style.fontSize]="defaultReportFontSize"
        >
          {{ ag.roomName }}
        </th>
      </tr>
      <tr *ngFor="let assignment of ag.assignments">
        <!-- td id is to find assignType later, not always has name, sometimes has theme -->
        <td
          [id]="assignment.assignType.id"
          class="bold me-3"
          [style.backgroundColor]="
            assignTypeService.getAssignType(assignment.assignType.id).color
          "
          [style.fontSize]="defaultReportFontSize"
        >
          <div>{{ assignment.theme }}</div>
          <span *ngIf="!assignment.theme">{{
            assignment.assignType.name
          }}</span>
        </td>
        <td [style.fontSize]="defaultReportFontSize">
          {{ assignment.principal.name
          }}<span *ngIf="assignment.assistant">
            / <br />
            {{ assignment.assistant.name }}</span
          >
        </td>
      </tr>
    </table>
  </ng-container>
</div>
