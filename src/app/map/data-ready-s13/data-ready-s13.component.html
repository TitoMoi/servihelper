<h3>Data ready for S13</h3>

<div class="row">
  <div class="col">
    <mat-form-field subscriptSizing="dynamic">
      <mat-label>Service year</mat-label>
      <input type="number" matInput spellcheck="false" [formControl]="serviceYearControl" />
    </mat-form-field>
  </div>
  <div class="col">
    <mat-icon class="m-2" svgIcon="word" aria-label="icon" (click)="toS13Pdf()"></mat-icon>
  </div>
</div>
<h4>Summary</h4>
<hr />

<div class="row justify-content-center g-5">
  <div class="col-auto">
    @for (territories of territoriesChunks; track $index) {
      <table>
        <thead>
          <tr>
            <th rowspan="2"></th>
            <th rowspan="2"></th>
          </tr>
          <tr></tr>
        </thead>
        <tbody>
          @for (t of territories; track $index) {
            <tr>
              <td class="center" rowspan="2" height="39px">{{ t.name }}</td>
              <td class="center" rowspan="2">
                {{
                  t.returnedDates.at(-1) ??
                    t.returnedDates.at(-2) ??
                    t.returnedDates.at(-3) ??
                    t.returnedDates.at(-4) | translocoDate: { dateStyle: "short" }
                }}
              </td>
            </tr>
            <tr></tr>
          }
        </tbody>
      </table>
      <hr />
    }
  </div>
  <div class="col">
    @for (territories of territoriesChunks; track $index) {
      <table>
        <thead>
          <tr>
            <th colspan="2"></th>
            <th colspan="2"></th>
            <th colspan="2"></th>
            <th colspan="2"></th>
          </tr>
          <tr>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          @for (t of territories; track $index) {
            <tr>
              <td style="background-color: lightgray" colspan="2">
                {{ (t.participants.at(-1) | participantPipe)?.name ?? "------------" }}
              </td>

              <td style="background-color: lightgray" colspan="2">
                {{ (t.participants.at(-2) | participantPipe)?.name ?? "------------" }}
              </td>

              <td style="background-color: lightgray" colspan="2">
                {{ (t.participants.at(-3) | participantPipe)?.name ?? "------------" }}
              </td>

              <td style="background-color: lightgray" colspan="2">
                {{ (t.participants.at(-4) | participantPipe)?.name ?? "------------" }}
              </td>
            </tr>
            <tr>
              <td>
                {{
                  t.assignedDates[t.participants.length - 1]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>

              <td>
                {{
                  t.returnedDates[t.participants.length - 1]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>

              <td>
                {{
                  t.assignedDates[t.participants.length - 2]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>

              <td>
                {{
                  t.returnedDates[t.participants.length - 2]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>

              <td>
                {{
                  t.assignedDates[t.participants.length - 3]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>

              <td>
                {{
                  t.returnedDates[t.participants.length - 3]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>

              <td>
                {{
                  t.assignedDates[t.participants.length - 4]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>

              <td>
                {{
                  t.returnedDates[t.participants.length - 4]
                    | translocoDate: { dateStyle: "short" }
                }}
              </td>
            </tr>
          }
        </tbody>
      </table>
      <hr />
    }
  </div>
</div>
