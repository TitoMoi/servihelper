<div class="row mb-2">
  <div class="col-auto">
    <!-- //Select the month for which you want to register publishers -->
    <mat-form-field>
      <mat-label>Month</mat-label>
      <mat-select [formControl]="selectedMonth">
        @for (month of months; track $index; let i = $index) {
          <mat-option [value]="i">{{ month | getMonthNamePipe: lang }}</mat-option>
        }
      </mat-select>
      <mat-hint>Pick a month first</mat-hint>
    </mat-form-field>
  </div>
  <div class="col-auto">
    <button
      mat-raised-button
      type="button"
      [disabled]="selectedMonth.invalid"
      (click)="updatePublisherRegistries()">
      Update registries
    </button>
    @if (showSpinner) {
      <mat-spinner class="ms-4" [diameter]="28" />
    }
  </div>
</div>
@if (selectedMonth.value >= 0) {
  <div class="row">
    <div class="col-9">
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Open details</th>
            <th>Has participated</th>
            <th>Bible studies</th>
            <th>Is aux. pioner</th>
            <th>Hours</th>
            <th>Notes</th>
          </tr>
        </thead>

        <tbody>
          @for (group of formGroupArray; track $index) {
            <tr>
              <td>
                <div>{{ group.controls.name.value }}</div>
                @if (group.controls.isRegPioner.value) {
                  <span class="f-small fst-italic">(Regular pioner)</span>
                }
              </td>
              <td (click)="openRegistryHeaderDetails(group.controls.id.value)">
                <span style="color: blue; cursor: pointer">Click me to open details</span>
              </td>
              <td><mat-checkbox [formControl]="group.controls.hasParticipated" /></td>
              <td>
                <mat-form-field>
                  <input matInput spellcheck="false" [formControl]="group.controls.bibleStudies" />
                </mat-form-field>
              </td>
              <td><mat-checkbox [formControl]="group.controls.isAuxPioner" /></td>
              <td>
                <mat-form-field>
                  <input matInput spellcheck="false" [formControl]="group.controls.hours" />
                </mat-form-field>
              </td>
              <td>
                <mat-form-field>
                  <input matInput spellcheck="false" [formControl]="group.controls.notes" />
                </mat-form-field>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
    <div class="col-3">
      <div class="row mt-5">
        <div class="col-12">
          <div>Todos los publicadores activos</div>
          <div class="fw-bold">{{ allActivePublishers() }}</div>
        </div>
        <hr class="m-2" />
      </div>
      <div class="row">
        <h4>Publicadores</h4>
        <div class="col-12">
          <div>Cantidad de informes</div>
          <div class="fw-bold">{{ numberOfReports() }}</div>
        </div>
        <div class="col-12">
          <div>Cursos bíblicos</div>
          <div class="fw-bold">{{ numberOfBibleStudies() }}</div>
        </div>
        <hr class="m-2" />
      </div>
      <div class="row">
        <h4>Precursores auxiliares</h4>
        <div class="col-12">
          <div>Cantidad de informes</div>
          <div class="fw-bold">{{ numberOfReportsAuxPioner() }}</div>
        </div>
        <div class="col-12">
          <div>Horas</div>
          <div class="fw-bold">{{ HoursAuxPioner() }}</div>
        </div>
        <div class="col-12">
          <div>Cursos bíblicos</div>
          <div class="fw-bold">{{ numberOfBibleStudiesAuxPioner() }}</div>
        </div>
        <hr class="m-2" />
      </div>
      <div class="row">
        <h4>Precursores regulares</h4>
        <div class="col-12">
          <div>Cantidad de informes</div>
          <div class="fw-bold">{{ numberOfReportsRegularPioner() }}</div>
        </div>
        <div class="col-12">
          <div>Horas</div>
          <div class="fw-bold">{{ HoursRegularPioner() }}</div>
        </div>
        <div class="col-12">
          <div>Cursos bíblicos</div>
          <div class="fw-bold">{{ numberOfBibleStudiesRegularPioner() }}</div>
        </div>
        <hr class="m-2" />
      </div>
    </div>
  </div>
}
