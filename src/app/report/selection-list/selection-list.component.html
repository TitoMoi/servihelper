<div *transloco="let t" class="d-flex align-items-center">
  <mat-icon
    class="m-2"
    svgIcon="bands"
    aria-label="icon"
    [matTooltip]="t('ICON_PDF_INFINITE')"
    (click)="toPdfOpinionated()"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="pdf"
    aria-label="icon"
    [matTooltip]="t('ICON_PDF_INFINITE')"
    (click)="toPdf(false)"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="pdfblue"
    aria-label="icon"
    [matTooltip]="t('ICON_PDF_PAGE')"
    (click)="toPdf(true)"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="png"
    aria-label="icon"
    [matTooltip]="t('ICON_PNG')"
    (click)="toPng()"
  ></mat-icon>
  <mat-icon
    class="m-2"
    svgIcon="excel"
    aria-label="icon"
    [matTooltip]="t('ICON_EXCEL')"
    (click)="toExcel()"
  ></mat-icon>
</div>

<div id="toPngDivId" style="width: 791px; height: auto" class="bg-color-white">
  <div *ngIf="reportTitle" class="fw-bold p-2" [style.textAlign]="'center'">
    {{ reportTitle }}
  </div>
  <ng-container *ngFor="let ag of assignmentGroups; index as i">
    <table [id]="'table' + i">
      <tr>
        <th
          class="fw-bold pt-2 pb-2"
          [style.backgroundColor]="defaultReportDateColor"
          [style.fontSize]="defaultReportFontSize"
          [style.width]="'65%'"
        >
          {{
            ag.date
              | translocoDate
                : {
                    dateStyle: defaultReportDateFormat
                  }
          }}
        </th>
        <th
          [style.backgroundColor]="defaultReportDateColor"
          [style.fontSize]="defaultReportFontSize"
        >
          {{ ag.roomName }}
        </th>
      </tr>
      <tr *ngFor="let assignment of ag.assignments">
        <!-- td id is to find assignType later, not always has name, sometimes has theme -->
        <td
          [id]="assignment.assignType.id"
          class="ps-3 pt-2"
          [style]="
            getBorderRight((assignment.assignType.id | assignTypePipe).color || 'transparent')
          "
          [style.fontSize]="defaultReportFontSize"
          [style.width]="'65%'"
        >
          <div class="me-3">
            {{
              assignment.theme
                ? assignment.theme
                : (assignment.assignType | assignTypeNamePipe)
            }}
          </div>
        </td>
        <td class="ps-3" [style.fontSize]="defaultReportFontSize">
          {{ assignment.principal.name
          }}<span *ngIf="assignment.assistant">
            / <br />
            {{ assignment.assistant.name }}</span
          >
        </td>
      </tr>
    </table>
  </ng-container>
</div>
